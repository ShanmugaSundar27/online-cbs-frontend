(this["webpackJsonponline-cbs-frontend"]=this["webpackJsonponline-cbs-frontend"]||[]).push([[0],{208:function(e,t,a){e.exports=a(422)},213:function(e,t,a){},214:function(e,t,a){},215:function(e,t,a){},422:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(5),l=a.n(o),c=(a(213),a(214),a(39)),i=a(47),s=a(189),u=a(21),m=(a(215),a(423)),p=a(68),d=a(6),h=a(32),f=m.a.Header,g=m.a.Sider,y=m.a.Content;var E=Object(i.g)((function(e){var t=Object(n.useState)(!0),a=Object(u.a)(t,2),o=a[0],l=a[1],i=Object(n.useState)(80),s=Object(u.a)(i,2),E=s[0],b=s[1],v=e.content;return r.a.createElement("div",null,r.a.createElement(m.a,{hasSider:!0,style:{minHeight:"100vh"}},r.a.createElement(g,{className:"sider",trigger:null,collapsible:!0,collapsed:o,width:"240px",style:{overflow:"auto",height:"100vh",position:"fixed",left:0,boxShadow:"3px 0 5px rgba(57, 63, 72, 0.6)",zIndex:101,textAlign:"left"},theme:"dark"},r.a.createElement("div",{className:"title"}),r.a.createElement(p.a,{theme:"dark",mode:"inline"},r.a.createElement(p.a.SubMenu,{title:r.a.createElement("span",null,r.a.createElement(d.a,{type:"tag"}),r.a.createElement("span",null,"Products"))},r.a.createElement(p.a.Item,null,r.a.createElement(c.b,{to:"/menu"},r.a.createElement("span",null,"All Products")))),r.a.createElement(p.a.Item,{key:"orders"},r.a.createElement(c.b,{to:"/orders"},r.a.createElement(d.a,{type:"appstore"}),r.a.createElement("span",null,"My Orders"))))),r.a.createElement(m.a,{style:{marginLeft:"".concat(E,"px")}},r.a.createElement(f,{style:{padding:0,width:"100%",zIndex:100,textAlign:"left"}},r.a.createElement("div",{className:"global-header"},r.a.createElement("span",{className:"global-header-trigger"},r.a.createElement(d.a,{type:o?"menu-unfold":"menu-fold",onClick:function(){l((function(e){return!e})),b((function(e){return 240===e?80:240}))}})),r.a.createElement(h.a,{style:{float:"right",margin:"10px"},type:"primary",onClick:function(){localStorage.removeItem("authToken"),e.history.push("/")}},"Logout"))),r.a.createElement(y,{style:{margin:"30px 16px",padding:24,background:"#fff",minHeight:280}},r.a.createElement(v,null)))))}));var b=function(e){var t=e.component,a=Object(s.a)(e,["component"]);return r.a.createElement(i.b,Object.assign({},a,{render:function(e){return localStorage.getItem("authToken")?r.a.createElement(E,Object.assign({content:t},e)):r.a.createElement(i.a,{to:{pathname:"/",state:{from:e.location}}})}}))},v=a(430),j=a(428),O=a(426),k=a(427),S=m.a.Header,x=m.a.Content,I=O.a.create({name:"home"})((function(e){var t="http://localhost:4000",a=Object(n.useState)(!1),o=Object(u.a)(a,2),l=o[0],c=o[1],i=Object(n.useState)(!1),s=Object(u.a)(i,2),m=s[0],p=s[1],f=Object(n.useState)(""),g=Object(u.a)(f,2),y=g[0],E=g[1],b=Object(n.useState)(""),I=Object(u.a)(b,2),w=I[0],C=I[1],P=Object(n.useState)(""),T=Object(u.a)(P,2),N=T[0],R=T[1],q=function(e,t){"mail"===t?E(e):"pass"===t?C(e):"cpass"===t&&R(e)},U=function(a){"signin"===a?(console.log(t+"/signin"),fetch(t+"/signin",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({mail:y,password:w})}).then((function(e){return e.json()})).then((function(t){t.authToken?(localStorage.setItem("authToken",t.authToken),e.history.push("/menu")):v.a.error({message:t.error,duration:2})})),E(""),C(""),c(!1)):"signup"===a&&fetch(t+"/signup",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({mail:y,password:w,role:"USER"})}).then((function(e){return e.json()})).then((function(t){t.error?alert("mail must be unique"===t.error?"Entered Mail id already exists":t.error):(localStorage.setItem("authToken",t.authToken),p(!1),E(""),C(""),R(""),e.history.push("/menu"))})).catch((function(e){return console.log(e)}))};return r.a.createElement("div",null,r.a.createElement(S,{style:{width:"100%",padding:"10px"}},r.a.createElement(h.a,{onClick:function(){return c(!0)},style:{float:"right",margin:"3px"},type:"primary"},"SignIn"),r.a.createElement(h.a,{onClick:function(){return p(!0)},style:{float:"right",margin:"3px"},type:"primary"},"SignUp")),r.a.createElement(x,{style:{margin:"20px 10px"}},r.a.createElement("h1",{style:{display:"block",fontWeight:"900"}},"Cashless Canteen Management System"),r.a.createElement("h3",{style:{display:"block"}},"Welcome user!!!"),r.a.createElement(j.a,{title:"SignIn",visible:l,onOk:function(){return U("signin")},okText:"SignIn",onCancel:function(){c(!1),E(""),C("")}},r.a.createElement(O.a,{className:"login-form"},r.a.createElement(O.a.Item,null,r.a.createElement(k.a,{prefix:r.a.createElement(d.a,{type:"mail",style:{color:"rgba(0,0,0,.25)"}}),value:y,placeholder:"Email",onChange:function(e){return q(e.target.value,"mail")}})),r.a.createElement(O.a.Item,null,r.a.createElement(k.a,{prefix:r.a.createElement(d.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",value:w,placeholder:"Password",onChange:function(e){return q(e.target.value,"pass")}}),r.a.createElement("span",{onClick:function(){0===y.length?v.a.error({message:"Enter Registered Email",placement:"topRight",duration:2}):fetch("".concat(t,"/resetpassword/").concat(y),{method:"get"}).then((function(e){return e.json()})).then((function(e){return"success"===e?v.a.info({message:"Check your mail"}):v.a.error({message:"Error sending mail"})}))},style:{color:"#42A7FA",padding:"3px",cursor:"pointer"}},"Reset Password")))),r.a.createElement(j.a,{title:"SignUp",visible:m,onOk:function(){return U("signup")},okText:"SignUp",onCancel:function(){p(!1),E(""),C(""),R("")}},r.a.createElement(O.a,null,r.a.createElement(O.a.Item,null,r.a.createElement(k.a,{type:"mail",prefix:r.a.createElement(d.a,{type:"mail",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Email",value:y,onChange:function(e){return q(e.target.value,"mail")}})),r.a.createElement(O.a.Item,null,r.a.createElement(k.a,{prefix:r.a.createElement(d.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password",value:w,onChange:function(e){return q(e.target.value,"pass")}})),r.a.createElement(O.a.Item,null,r.a.createElement(k.a,{prefix:r.a.createElement(d.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Conform Password",value:N,onChange:function(e){return q(e.target.value,"cpass")}}))))))})),w=Object(i.g)(I),C=a(80),P=a(58),T=a(111),N=a(81),R=a(429),q=a(431),U=a(425),A=a(146),J=a.n(A),L=a(198),_=a.n(L);var D=function(e){var t=100*e.price;return r.a.createElement(_.a,{currency:"INR",amout:t,style:{backgroundColor:"red"},label:"Pay \u20b9".concat(t/100," with card"),name:"CCMS",description:"Your Total Bill amout is ".concat(e.price),panelLabel:"Pay Now",token:function(a){return e.onToken(t,a)},stripeKey:"pk_test_7JVYiEe3si6bekwA2ntQFti400iZPKw9gs"})},B=a(109),H=N.a.Option,M=Object(B.b)((function(e){return{URL:e.URL}}),null)(Object(i.g)((function(e){var t=Object(n.useState)([]),a=Object(u.a)(t,2),o=a[0],l=a[1],c=Object(n.useState)([]),i=Object(u.a)(c,2),s=i[0],m=i[1],p=Object(n.useState)(!1),f=Object(u.a)(p,2),g=f[0],y=f[1],E=Object(n.useState)({}),b=Object(u.a)(E,2),v=b[0],O=b[1],S=Object(n.useState)("name"),x=Object(u.a)(S,2),I=x[0],w=x[1],A=Object(n.useState)(0),L=Object(u.a)(A,2),_=L[0],B=L[1],M=e.URL;console.log(M),Object(n.useEffect)((function(){localStorage.getItem("authToken")?fetch(M+"/verifytoken",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:localStorage.getItem("authToken")})}).then((function(e){return e.json()})).then((function(t){t.data?console.log(t.data):(localStorage.removeItem("authToken"),e.history.push("/"))})):W()}),[]);var W=function(){};Object(n.useEffect)((function(){F()}),[]);var F=function(){fetch(M+"/getmenu",{method:"get"}).then((function(e){return e.json()})).then((function(e){return m(e.sort((function(e,t){return e.name>t.name?1:-1})))}))};return r.a.createElement("div",null,r.a.createElement("script",{src:"https://js.stripe.com/v3/"}),r.a.createElement(R.a,{title:"All Products",extra:r.a.createElement(h.a,{type:"primary",style:{position:"absolute",right:"20px",top:"20px",width:"60px"},onClick:function(){var e=0;o.map((function(t){var a=s.filter((function(e){return t.id==e.id}));return console.log(t,a),e+=t.quantity>0?t.quantity*a[0].price:0})),B(e),y(!0)}},r.a.createElement(q.a,{style:{marginLeft:"5px"},count:o.length},r.a.createElement(d.a,{type:"shopping-cart",style:{fontSize:"20px",padding:"3px"}}),r.a.createElement("span",{style:{width:"10px"}})))}),r.a.createElement("span",{style:{paddingRight:"20px",fontWeight:"900"}},"Sort By"),r.a.createElement(N.a,{value:I,style:{width:"150px"},onChange:function(e){w(e);var t=Object(T.a)(s);console.log(t),"name"===e?t.sort((function(e,t){return e.name>t.name?1:-1})):"high_price"===e?t.sort((function(e,t){return e.price<=t.price?1:-1})):"low_price"===e?t.sort((function(e,t){return e.price>t.price?1:-1})):t.sort((function(e,t){return e.menu.quantity<t.menu.quantity?1:-1})),m(t)}},[["name","Name"],["high_price","High Price"],["low_price","Low Price"],["quantity","Quantity"]].map((function(e){return r.a.createElement(H,{key:e[0],value:e[0]},e[1])}))),r.a.createElement("div",{style:{paddingTop:"90px"}},s.map((function(e,t){return 0!==e.menu.quantity?r.a.createElement(U.a,{key:t,style:{width:"250px",display:"inline-block",margin:"15px",height:"420px",verticalAlign:"top"},cover:r.a.createElement("img",{src:e.image.replace("http://localhost:4000",M),alt:e.name,height:200,width:250}),actions:[r.a.createElement(h.a,{id:e.id,onClick:function(e){return function(e){var t=!1,a=Object(T.a)(o);if(0!==v[e]&&void 0!==v[e]){for(var n=0;n<a.length;n++)a[n].id===e&&(a[n].quantity=v[e],t=!0);t||(a=[].concat(Object(T.a)(a),[{id:e,quantity:v[e]}])),l(a)}else{for(var r=0;r<a.length;r++)a[r].id===e&&a.splice(r,1);l(a)}}(e.target.id)}},r.a.createElement(d.a,{type:"plus"}),"Add to cart")]},r.a.createElement(J.a,{title:e.name,description:r.a.createElement("div",null,r.a.createElement(k.a,{style:{width:"40%"},placeholder:"Quantity",id:"".concat(e.id),value:0!==v[e.id]?v[e.id]:null,type:"number",onChange:function(e){return parseInt(e.target.value)<=5&&parseInt(e.target.value)>=0||""===e.target.value?O(Object(P.a)({},v,Object(C.a)({},e.target.id,""!==e.target.value?parseInt(e.target.value):0))):""}}),r.a.createElement("p",{style:{marginBottom:"0px"}},"Price \u20b9",e.price),r.a.createElement("p",null,"Available :",e.menu.quantity))})):""}))),r.a.createElement(j.a,{visible:g,onCancel:function(){return y(!1)},footer:0!==o.length?r.a.createElement(D,{onToken:function(e,t){console.log("Payment Successful"),fetch(M+"/stripe",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({price:e,stripeTokenId:t.id})}).then((function(e){return e.json()})).then((function(e){return t=e,console.log(t),fetch(M+"/addorder",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:localStorage.getItem("authToken"),status:"PENDING",recieptUrl:t.receipt_url,billAmount:t.amount/100,paymentId:t.id,orderItems:o.map((function(e){return{productId:e.id,quantity:e.quantity}}))})}).then((function(e){return e.json()})).then((function(e){return console.log(JSON.stringify(e))})),l([]),O({}),y(!1),void F();var t}))},price:_}):null,cancelText:"Close",title:r.a.createElement("h2",null,"Cart")},r.a.createElement("div",null,o.map((function(e,t){var a=s.filter((function(t){return e.id==t.id}));return e.quantity>0?r.a.createElement(U.a,{key:t,style:{width:"200px",display:"inline-block",margin:"5px"},actions:[r.a.createElement(h.a,{id:a[0].id,onClick:function(e){return function(e){var t=o.filter((function(t){return t.id!==e}));O(Object(P.a)({},v,Object(C.a)({},e,0))),l(t)}(e.target.id)}},r.a.createElement(d.a,{type:"minus"}),"Remove")]},r.a.createElement(J.a,{title:a[0].name,description:r.a.createElement("div",null,r.a.createElement("p",null,"Quantity: ",e.quantity),r.a.createElement("p",null,"Price Per Unit: ",a[0].price),r.a.createElement("p",null,"Price: ",e.quantity*a[0].price))})):r.a.createElement("p",null)})),0!==o.length?r.a.createElement("p",{style:{position:"relative",left:"33%",fontSize:"25px",fontWeight:"800",top:"20px"}},"Total Bill: ",_):r.a.createElement("p",null,"No Items Added")),r.a.createElement("div",{id:"container"})))}))),W=a(424);var F=function(e){var t=Object(n.useState)([]),a=Object(u.a)(t,2),o=a[0],l=a[1],c="http://localhost:4000";Object(n.useEffect)((function(){localStorage.getItem("authToken")?fetch(c+"/verifytoken",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:localStorage.getItem("authToken")})}).then((function(e){return e.json()})).then((function(e){e.data?console.log(e.mail):localStorage.removeItem("authToken")})):i()}),[]),Object(n.useEffect)((function(){fetch("".concat(c,"/ordersbyuser/").concat(localStorage.getItem("authToken")),{method:"get"}).then((function(e){return e.json()})).then((function(e){return l(e)}))}),[]);var i=function(){},s=[{title:"Order Id",dataIndex:"id",key:"orderId"},{title:"Number of Items",dataIndex:"orderItems.length",key:"noOdfItems"},{title:"OTP",dataIndex:"otp",key:"otp"},{title:"Payment ID",dataIndex:"paymentId",key:"paymentId"},{title:"Bill",dataIndex:"billAmount",key:"billAmount",render:function(e){return r.a.createElement("span",null,"\u20b9".concat(e))}},{title:"Payment Reciept",dataIndex:"recieptUrl",key:"recieptUrl",render:function(e){return r.a.createElement("a",{href:e},"Reciept")}},{title:"Status",dataIndex:"status",key:"status",render:function(e){return"PENDING"===e?"OPEN":"CLOSE"}}],m=[{title:"Item",dataIndex:"product.name",key:"productName"},{title:"Quantity",dataIndex:"quantity",key:"quantity"},{title:"Price Per Unit",dataIndex:"product.price",key:"price"}];return r.a.createElement("div",null,r.a.createElement(R.a,{title:"My Orders"}),r.a.createElement(W.a,{columns:s,dataSource:o,expandedRowRender:function(e){return r.a.createElement(W.a,{pagination:!1,columns:m,dataSource:e.orderItems})}}))};var Q=O.a.create({name:"password_recovery"})(Object(i.g)((function(e){var t=Object(n.useState)(""),a=Object(u.a)(t,2),o=a[0],l=a[1],c="http://localhost:4000";console.log(c),Object(n.useEffect)((function(){var t=new URLSearchParams(window.location.search).get("a");fetch(c+"/verifytoken",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t})}).then((function(e){return e.json()})).then((function(t){console.log(t),t.data.id?l(t.data.id):(console.log("error"),e.history.push("/"))})).catch((function(e){return console.log("error",e)}))}),[]);var i=e.form.getFieldDecorator;return r.a.createElement("div",{style:{width:"300px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"}},r.a.createElement(O.a,{onSubmit:function(t){t.preventDefault();var a=e.form.getFieldsValue();console.log(a),a.password&&a.cPassword?a.password===a.cPassword?fetch(c+"/updatepassword",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:o,password:a.password})}).then((function(e){return e.json()})).then((function(t){"success"===t?v.a.success({message:"Password Updated",duration:2}):v.a.error({message:"Password Updation Failed",duration:2}),e.history.push("/")})).catch((function(e){return v.a.error({message:e})})):v.a.error({message:"Passwords Did not match",duration:3}):v.a.error({message:"Enter password",duration:3})},className:"login-form"},r.a.createElement("h1",{style:{fontWeight:"900"}},"Recover Password"),r.a.createElement(O.a.Item,null,i("password",{rules:[{required:!0,message:"Please input your username!"}]})(r.a.createElement(k.a,{type:"password",prefix:r.a.createElement(d.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Password"}))),r.a.createElement(O.a.Item,null,i("cPassword",{rules:[{required:!0,message:"Please input your Password!"}]})(r.a.createElement(k.a,{prefix:r.a.createElement(d.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Retype Password"}))),r.a.createElement(O.a.Item,null,r.a.createElement(h.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Submit"))))})));var z=function(){return r.a.createElement("div",null,r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:"/",component:w}),r.a.createElement(b,{path:"/menu",component:M}),r.a.createElement(b,{path:"/orders",component:F}),console.log("Hit"),r.a.createElement(i.b,{path:"/recoverpassword",component:Q}),r.a.createElement(b,{render:function(){return r.a.createElement("h3",null,"Route not found")}})))},G=a(77),K={signedIn:!1,user:null,a:null,URL:"http://localhost:4000"};var V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(console.log(e),t.type){case"USER_SIGNED_IN":return Object(P.a)({},e,{signedIn:t.payload});case"SET_USER":return console.log(Object(P.a)({},e,{user:t.payload})),Object(P.a)({},e,{user:t.payload});default:return e}},Y=a(202),Z=Object(G.createStore)(V,Object(Y.composeWithDevTools)());var X=function(){return r.a.createElement(B.a,{store:Z},r.a.createElement("div",{className:"App"},r.a.createElement(c.a,null,r.a.createElement(z,{URL:"http://localhost:4000"}))))};a(421);l.a.render(r.a.createElement(X,null),document.getElementById("root"))}},[[208,1,2]]]);
//# sourceMappingURL=main.b13f0385.chunk.js.map